@echo off
chcp 65001 > nul

echo ========================================
echo   TripMind Travel Planning System
echo   Model: ZhipuAI GLM-4.5
echo ========================================
echo.

REM 请填入你的智谱 AI API Key
set ZHIPUAI_API_KEY=your-api-key-here

if "%ZHIPUAI_API_KEY%"=="your-api-key-here" (
    echo Error: Please set ZHIPUAI_API_KEY first!
    echo Edit this file and replace 'your-api-key-here' with your actual API key.
    echo Get your API key from: https://open.bigmodel.cn/
    pause
    exit /b 1
)

echo API Key configured: %ZHIPUAI_API_KEY:~0,8%...
echo.

echo [1/2] Starting OpenAgents Network...
echo   - HTTP Port: 8700
echo   - gRPC Port: 8600
echo   - Working Directory: %CD%
echo.

start "TripMind Network" cmd /k "chcp 65001 > nul & call conda activate openagents & set ZHIPUAI_API_KEY=%ZHIPUAI_API_KEY% & set PYTHONIOENCODING=utf-8 & cd /d %CD% & echo Starting network... & openagents network start . 2>&1"

echo Waiting for Network to start...
timeout /t 8 /nobreak > nul

echo.
echo [2/2] Starting OpenAgents Studio...
echo   - Studio Port: 8050
echo.

start "TripMind Studio" cmd /k "chcp 65001 > nul & call conda activate openagents & set PYTHONIOENCODING=utf-8 & echo Starting studio... & openagents studio -s 2>&1"

echo Waiting for Studio to start...
timeout /t 5 /nobreak > nul

echo.
echo ========================================
echo   TripMind System Started!
echo ========================================
echo.
echo Studio UI: http://localhost:8050
echo Network API: http://localhost:8700
echo Model: ZhipuAI GLM-4.5
echo.
echo Next: Run start_agents.bat to start all agents
echo.
pause
