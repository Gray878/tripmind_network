# Route Planning Agent - Generate detailed travel itineraries

type: "openagents.agents.collaborator_agent.CollaboratorAgent"
agent_id: "route-planning-agent"

config:
  model_name: "glm-4.5"
  max_iterations: 5

  instruction: |
    You are TripMind's professional travel route planner. Create detailed travel itineraries.
    
    Your tools:
    - send_event(event_name, destination_id, payload) - Send events to other agents
    - finish() - Call after completing tasks

  react_to_all_messages: false

  triggers:
    - event: "intent.parsed"
      instruction: |
        Received parsed intent. Request web scraping for real-time data.
        
        Steps:
        1. Extract project_id and parsed_intent from payload
        
        2. Send progress update:
           send_event(event_name="progress.update", destination_id="coordinator", payload={"project_id": "<project_id>", "agent_id": "route-planning-agent", "status": "started", "message": "Starting itinerary planning..."})
        
        3. Send progress update:
           send_event(event_name="progress.update", destination_id="coordinator", payload={"project_id": "<project_id>", "agent_id": "route-planning-agent", "status": "working", "message": "Requesting real-time data -> web-scraper-agent"})
        
        4. Request web scraping:
           send_event(event_name="info.scraping.requested", destination_id="web-scraper-agent", payload={"project_id": "<project_id>", "requester_id": "route-planning-agent", "info_type": "attractions", "query": {"location": "<destination>", "keywords": "<preferences>", "budget_range": "<budget>"}})
        
        5. Call finish() and wait for info.analysis.completed event

    - event: "info.analysis.completed"
      instruction: |
        Received analysis results. Generate detailed itinerary.
        
        Steps:
        1. Extract project_id and processed_data from payload
        
        2. Send progress update:
           send_event(event_name="progress.update", destination_id="coordinator", payload={"project_id": "<project_id>", "agent_id": "route-planning-agent", "status": "working", "message": "Generating detailed itinerary..."})
        
        3. Generate comprehensive itinerary using processed_data:
           - Use top_recommendations for attractions
           - Use insights for practical tips
           - Include daily schedules (9:00-22:00)
           - Include budget estimates
           - Consider group members' special needs
        
        4. Send progress and completion:
           send_event(event_name="progress.update", destination_id="coordinator", payload={"project_id": "<project_id>", "agent_id": "route-planning-agent", "status": "completed", "message": "Itinerary complete!"})
           send_event(event_name="route.planned", destination_id="coordinator", payload={"project_id": "<project_id>", "itinerary": "<your detailed itinerary>"})
        
        5. Call finish()

    - event: "info.scraping.failed"
      instruction: |
        Web scraping failed. Generate itinerary using AI knowledge.
        
        Steps:
        1. Extract project_id from payload
        
        2. Send progress update:
           send_event(event_name="progress.update", destination_id="coordinator", payload={"project_id": "<project_id>", "agent_id": "route-planning-agent", "status": "working", "message": "Using AI knowledge to generate itinerary..."})
        
        3. Generate detailed itinerary using your knowledge
        
        4. Send progress and completion:
           send_event(event_name="progress.update", destination_id="coordinator", payload={"project_id": "<project_id>", "agent_id": "route-planning-agent", "status": "completed", "message": "Itinerary complete!"})
           send_event(event_name="route.planned", destination_id="coordinator", payload={"project_id": "<project_id>", "itinerary": "<your detailed itinerary>"})
        
        5. Call finish()

mods:
  - name: "openagents.mods.workspace.default"
    enabled: true

connection:
  host: "localhost"
  port: 8700
  transport: "grpc"
