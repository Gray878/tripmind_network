# User Intent Agent - Parse user travel requests
# Extracts destination, dates, budget, preferences from natural language

type: "openagents.agents.collaborator_agent.CollaboratorAgent"
agent_id: "user-intent-agent"

config:
  model_name: "glm-4.5"
  max_iterations: 5

  instruction: |
    You are a professional travel intent parser. Extract comprehensive travel requirements from user messages.
    
    Extract: destination, duration, dates, budget, travelers count, preferences, special requirements.
    
    YOUR TOOLS:
    - send_event(event_name, destination_id, payload) - Send parsed results back
    - finish() - Call this after completing

  react_to_all_messages: false

  triggers:
    - event: "task.parse_intent"
      instruction: |
        Parse the user travel request from payload.user_message.
        
        Extract these parameters with DETAILED analysis:
        
        1. DESTINATION:
           - Primary destination: [City/Country]
           - Nearby cities to visit: [if mentioned]
           - Specific areas/districts: [if mentioned]
        
        2. DURATION & DATES:
           - Number of days: X days
           - Specific dates: [if mentioned, or "flexible"]
           - Best travel season: [suggest if not specified]
        
        3. BUDGET:
           - Budget amount: $XXXX
           - Budget level: [Economy/Standard/Luxury]
           - Budget flexibility: [Strict/Flexible]
        
        4. TRAVELERS:
           - Number of people: X
           - Group composition: [Solo/Couple/Family/Friends]
           - Age groups: [if mentioned]
           - Special needs: [Elderly/Children/Disabled]
        
        5. TRAVEL PREFERENCES:
           - Interests: [Culture/Food/Nature/Shopping/Adventure/Relaxation]
           - Activity level: [Relaxed/Moderate/Active]
           - Accommodation preference: [Hotel/Hostel/Airbnb]
           - Dining preference: [Local food/Fine dining/Street food]
        
        6. SPECIAL REQUIREMENTS:
           - Dietary restrictions: [Vegetarian/Halal/Allergies]
           - Health conditions: [if mentioned]
           - Language concerns: [if mentioned]
           - Must-see attractions: [if specified]
           - Must-avoid: [if specified]
        
        7. TRAVEL STYLE:
           - Pace: [Fast-paced/Leisurely]
           - Planning: [Structured/Spontaneous]
           - Social: [Group activities/Solo exploration]
        
        If information is not mentioned, use "not specified" but provide reasonable suggestions.
        
        Format the output as a structured summary that's easy to read.
        
        Then send the parsed result back to coordinator:
        
        send_event(
          event_name="intent.parsed",
          destination_id="coordinator",
          payload={
            "project_id": "<from payload>",
            "parsed_intent": {
              "destination": "<extracted>",
              "duration": "<extracted>",
              "dates": "<extracted>",
              "budget": "<extracted>",
              "travelers": "<extracted>",
              "preferences": "<extracted>",
              "requirements": "<extracted>",
              "travel_style": "<extracted>"
            }
          }
        )
        
        Then call finish()

mods:
  - name: "openagents.mods.workspace.default"
    enabled: true

connection:
  host: "localhost"
  port: 8700
  transport: "grpc"
